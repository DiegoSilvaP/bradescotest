<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <title>Vanilla JavaScript App</title>
  </head>

  <body>
    <main>
      <h1>Login through B2C custom policy (iframe)</h1>
      <iframe
        id="loginframe"
        frameborder="0"
        width="650"
        height="560"
        src="https://login.bradescob2ctest.tk/BradescoTest1.onmicrosoft.com/oauth2/v2.0/authorize?p=B2C_1A_SIGNUP_SIGNIN&client_id=3df67037-6caa-4807-b870-d8d759789964&nonce=defaultNonce&redirect_uri=https%3A%2F%2Fwww.bradescob2ctest.tk%2Fredirect&scope=openid&response_type=id_token&prompt=login"
      ></iframe>
      <button type="button" onclick="getToken()"></button>
    </main>
  </body>

  <script>
    function getToken() {
      if (
        !document
          .getElementById("loginframe")
          .contentDocument.getElementById("txtToken")
          .value.includes("#id_token")
      ) {
        console.log("Inicia sesion");
      } else {
        var para = document.createElement("P");
        para.innerText = document
          .getElementById("loginframe")
          .contentDocument.getElementById("txtToken").value;
        document.body.appendChild(para);
      }
    }
  </script>
</html>
